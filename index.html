<!DOCTYPE html>
<html lang="en">

<head>
 <meta charset="UTF-8" />
 <meta name="viewport"
  content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no" />

 <title>FinovaCash Dashboard</title>
 <script src="https://cdn.tailwindcss.com/3.4.16"></script>
 <script>
  tailwind.config = {
   theme: {
    extend: {
     colors: { primary: "#5B68FF", secondary: "#FF6B6B" },
     borderRadius: {
      none: "0px",
      sm: "4px",
      DEFAULT: "8px",
      md: "12px",
      lg: "16px",
      xl: "20px",
      "2xl": "24px",
      "3xl": "32px",
      full: "9999px",
      button: "8px",
     },
    },
   },
  };
 </script>
 <link rel="preconnect" href="https://fonts.googleapis.com" />
 <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
 <link href="https://fonts.googleapis.com/css2?family=Pacifico&display=swap" rel="stylesheet" />
 <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/remixicon/4.6.0/remixicon.min.css" />


 <script src="https://telegram.org/js/telegram-web-app.js"></script>


 <style>
  .gradient-bg {
   background: linear-gradient(135deg, #F8F9FE 0%, #FFFFFF 100%);
  }

  .glass-effect {
   backdrop-filter: blur(10px);
   background: rgba(255, 255, 255, 0.9);
  }

  .glow-effect {
   box-shadow: 0 0 20px rgba(91, 104, 255, 0.3);
  }

  .card-shadow {
   box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
  }

  .pulse-animation {
   animation: pulse 2s infinite;
  }

  @keyframes pulse {

   0%,
   100% {
    transform: scale(1);
   }

   50% {
    transform: scale(1.05);
   }
  }

  .spin-animation {
   animation: spin 3s linear infinite;
  }

  @keyframes spin {
   from {
    transform: rotate(0deg);
   }

   to {
    transform: rotate(360deg);
   }
  }

  .scratch-effect {
   background: linear-gradient(45deg, #FFD93D, #FFA500);
  }

  .tap-effect {
   transition: transform 0.1s;
  }

  .tap-effect:active {
   transform: scale(0.95);
  }




  /* Custom scrollbar for main element */
  html::-webkit-scrollbar {
   width: 10px;
  }

  html::-webkit-scrollbar-track {
   background: #f1f1f1;
   border-radius: 5px;
  }

  html::-webkit-scrollbar-thumb {
   background: linear-gradient(to bottom, #8B5CF6, #6366F1);
   border-radius: 5px;
  }

  html::-webkit-scrollbar-thumb:hover {
   background: linear-gradient(to bottom, #7C3AED, #4F46E5);
  }

  /* For Firefox */
  html {
   scrollbar-width: thin;
   scrollbar-color: #6366F1 #f1f1f1;
  }

  .page { display: none; }
  .page.active { display: block; }

 </style>


 <!-- Firebase SDKs -->
 <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app.js"></script>
 <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-auth.js"></script>
 <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-database.js"></script>

 <script src='//libtl.com/sdk.js' data-zone='9712189' data-sdk=''></script>

</head>
<body class="bg-gray-50 min-h-screen">
  <!-- Header -->
<header class="fixed top-0 w-full z-50 bg-white border-b border-gray-100" style="height: auto; padding-top: 40px;">
  <div class="flex flex-col h-full px-4 py-2 justify-between">

    <!-- Top Row: Bot Name + Verified -->
    <div class="flex items-center justify-center border-b border-gray-100">
      <p class="font-bold text-gray-800 text-xl truncate py-2 max-w-[300px]">
        FinovaCash
      </p>
      <i class="ri-verified-badge-fill text-blue-500 text-lg ml-1"></i>
    </div>

    <div class="flex items-center justify-between py-1">

      <div class="flex items-center space-x-3">
        <div class="w-10 h-10 rounded-full overflow-hidden border-2 border-white card-shadow">
          <img id="profile-photo" src="https://i.imgur.com/placeholder.png" alt="Profile" class="w-full h-full object-cover" />
        </div>
        <div>
          <div class="flex items-center space-x-1">
            <span id="user-name" class="font-semibold text-gray-800 text-sm truncate max-w-[250px] block">
              Loading...
            </span>
            <i class="ri-verified-badge-fill text-green-500 text-sm"></i>
          </div>
          <div id="user-username" class="text-xs text-gray-500 truncate max-w-[250px] block">
            Loading...
          </div>
        </div>
      </div>

      <!-- Right: Balance -->
      <div class="text-right">
        <div class="flex items-center justify-end space-x-1 text-sm font-semibold text-gray-800">
          <i class="ri-money-dollar-circle-line text-green-500"></i>
          <span id="usdt-balance">0.000</span>
          <span class="text-xs text-gray-500">USDT</span>
        </div>
        <div class="flex items-center justify-end space-x-1 text-xs text-gray-600">
          <i class="ri-coin-line text-yellow-500"></i>
          <span id="lmt-balance">0</span>
          <span class="text-[10px] text-gray-500">LMT</span>
        </div>
      </div>

    </div>
  </div>
</header>
  <!-- Main Content -->
  <main class=" px-4" style="padding-top: 170px;  padding-bottom: 150px;">
    <div id="home-page" class="page active">
    <!-- Welcome Section -->
    <section class="mb-6">
      <h1 class="text-xl font-bold text-gray-800 mb-1">
        Welcome back, <span id="welcome-name">Loading...</span>!
      </h1>
      <p id="joined-text" class="text-sm text-gray-600">
        Loading...
      </p>
    </section>


    <!-- Stats Grid -->
    <section class="grid grid-cols-2 gap-3 mb-6">
      <div class="bg-white rounded-lg p-4 card-shadow">
        <div class="flex items-center mb-2">
          <div class="w-6 h-6 flex items-center justify-center mr-2">
            <i class="ri-money-dollar-circle-fill text-green-500"></i>
          </div>
          <span class="text-xs text-gray-600">USD Balance</span>
        </div>

        <!-- Total balance -->
        <div class="text-lg font-bold text-gray-800">
          <span id="usdt-balance-stat">0.000 USDT</span>
        </div>

        <!-- Added today -->
        <div class="text-xs text-green-600">
          +0.000
          today
        </div>
      </div>


      <div class="bg-white rounded-lg p-4 card-shadow">
        <div class="flex items-center mb-2">
          <div class="w-6 h-6 flex items-center justify-center mr-2">
            <i class="ri-coin-fill text-yellow-500"></i>
          </div>
          <span class="text-xs text-gray-600"> LMT</span>
        </div>
        <div class="text-lg font-bold text-gray-800"><span id="lmt-balance-stat">0 LMT</span>
        </div>
        <div class="text-xs text-blue-600">
          +0
          today</div>
      </div>

      <div class="bg-white rounded-lg p-4 card-shadow">
        <div class="flex items-center mb-2">
          <div class="w-6 h-6 flex items-center justify-center mr-2">
            <i class="ri-group-fill text-blue-500"></i>
          </div>
          <span class="text-xs text-gray-600">Referrals</span>
        </div>

        <!-- Total referrals -->
        <div class="text-lg font-bold text-gray-800">
          <span id="referrals-total">0</span>
        </div>

        <!-- Referrals this week -->
        <div class="text-xs text-purple-600">
          +0
          this week
        </div>
      </div>


      <div class="bg-white rounded-lg p-4 card-shadow">
        <div class="flex items-center mb-2">
          <div class="w-6 h-6 flex items-center justify-center mr-2">
            <i class="ri-play-circle-fill text-red-500"></i>
          </div>
          <span class="text-xs text-gray-600">Ads Viewed</span>
        </div>

        <!-- Total ads viewed -->
        <div class="text-lg font-bold text-gray-800">
          <span id="ads-total">0</span>
        </div>

        <!-- Ads viewed today -->
        <div class="text-xs text-orange-600">
          +0
          today
        </div>
      </div>

    </section>

    <section class="grid grid-cols-1 gap-3 mb-6">
      <!-- Refer & Earn Card -->
      <a onClick="showLoading(true);" href="https://lumetra.tzsmm.my.id/refer?initData=query_id%3DAAFdsaoAAwAAAF2xqgD71Pgk%26user%3D%257B%2522id%2522%253A6453637469%252C%2522first_name%2522%253A%2522%25F0%259F%2590%25A4%2520Mohammad%2520Tanvir%2520Ahmed%2522%252C%2522last_name%2522%253A%2522Zihad%2522%252C%2522username%2522%253A%2522mohammadtanvir707%2522%252C%2522language_code%2522%253A%2522en%2522%252C%2522allows_write_to_pm%2522%253Atrue%252C%2522photo_url%2522%253A%2522https%253A%255C%252F%255C%252Ft.me%255C%252Fi%255C%252Fuserpic%255C%252F320%255C%252FzoZJyw5Ox-NZeaOKbj0Y_RxZ_7PJ9e9pWW8OqPxBk9-izZLUIdJdyVKllp2T_W0H.svg%2522%257D%26auth_date%3D1758460075%26signature%3DP58Q2grWwxX2z4jWL6eKtjc6tt5LEaPWFYbKWglnjKXKCDThqUURqwjn4b2xKQcjJXsSnXEpJpsuP3QEVDhGAQ%26hash%3De18a8ff5b17362038aa9045e40e3d6596359f9b26ad251b947ecf9e3f4d3951e"
        class="block bg-gradient-to-r from-blue-500 to-indigo-600 rounded-sm shadow-xl p-5 transition transform relative overflow-hidden">
        <div class="flex items-center justify-between">
          <div>
            <h3 class="text-lg font-bold text-white mb-1">💸 Refer & Earn</h3>
            <p class="text-sm text-white/90">
              Invite friends and earn <span class="font-extrabold">11%</span> commission on
              every successful referral.
            </p>
          </div>
          <div class="text-4xl text-white opacity-30">
            <i class="ri-share-forward-fill"></i>
          </div>
        </div>

        <!-- Decorative SVG / Icon -->
        <div class="absolute -bottom-6 -right-6 opacity-20 w-32 h-32">
          <svg xmlns="http://www.w3.org/2000/svg" class="w-full h-full" fill="none" viewBox="0 0 24 24"
            stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
              d="M12 6v6h4.5M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
          </svg>
        </div>
      </a>

    </section>

    </div>

    <div id="earn-page" class="page">
      <h2 class="text-xl font-bold text-gray-800 mb-4">Earn More</h2>
      <div class="grid gap-4">
        <!-- Watch Ad -->
        <div class="bg-white rounded-lg p-4 card-shadow">
          <div class="flex items-center mb-2">
            <i class="ri-video-line text-blue-500 text-2xl mr-3"></i>
            <div>
              <h3 class="font-semibold text-gray-800">Watch a Rewarded Ad</h3>
              <p class="text-sm text-gray-600">Earn 0.001 USDT for every ad.</p>
            </div>
          </div>
          <button id="watch-ad-btn" class="w-full bg-primary text-white py-2 rounded-button mt-2 tap-effect">Watch Ad</button>
        </div>
        <!-- Join Channel -->
        <div class="bg-white rounded-lg p-4 card-shadow">
          <div class="flex items-center mb-2">
            <i class="ri-telegram-line text-blue-400 text-2xl mr-3"></i>
            <div>
              <h3 class="font-semibold text-gray-800">Join Our Channel</h3>
              <p class="text-sm text-gray-600">Get 0.05 USDT bonus.</p>
            </div>
          </div>
          <button id="join-channel-btn" class="w-full bg-primary text-white py-2 rounded-button mt-2 tap-effect">Join & Claim Bonus</button>
        </div>
        <!-- Join Group -->
        <div class="bg-white rounded-lg p-4 card-shadow">
          <div class="flex items-center mb-2">
            <i class="ri-group-line text-green-500 text-2xl mr-3"></i>
            <div>
              <h3 class="font-semibold text-gray-800">Join Our Group</h3>
              <p class="text-sm text-gray-600">Get 0.01 USDT bonus.</p>
            </div>
          </div>
          <button id="join-group-btn" class="w-full bg-primary text-white py-2 rounded-button mt-2 tap-effect">Join & Claim Bonus</button>
        </div>
      </div>
    </div>

    <div id="wallet-page" class="page">
      <h2 class="text-xl font-bold text-gray-800 mb-4">Withdraw</h2>
      <p class="text-sm text-gray-600 mb-4">Minimum 1 USDT required to withdraw.</p>
      <form id="withdraw-form" class="grid gap-4">
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">Method:</label>
          <select id="withdraw-method" class="w-full p-3 border border-gray-300 rounded-lg">
            <option value="Bkash">Bkash</option>
            <option value="Nagad">Nagad</option>
            <option value="Binance">Binance</option>
          </select>
        </div>
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">Account Number/ID:</label>
          <input type="text" id="account-number" placeholder="e.g., 012345..." class="w-full p-3 border border-gray-300 rounded-lg">
        </div>
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">Amount (USDT):</label>
          <input type="number" id="amount" placeholder="e.g., 1" class="w-full p-3 border border-gray-300 rounded-lg">
        </div>
        <button type="submit" id="withdraw-submit-btn" class="w-full bg-primary text-white py-3 rounded-lg tap-effect">
          <span class="btn-text">Submit Request</span>
          <span class="btn-loader hidden"></span>
        </button>
      </form>
    </div>

    <div id="refer-page" class="page">
      <h2 class="text-xl font-bold text-gray-800 mb-4">Refer & Earn</h2>
      <p class="text-sm text-gray-600 mb-4">Share your link to get bonus.</p>
      <input type="text" id="referral-link" readonly class="w-full p-3 border border-gray-300 rounded-lg mb-2">
      <button id="copy-ref-link-btn" class="w-full bg-primary text-white py-3 rounded-lg tap-effect">Copy Referral Link</button>
    </div>

    <div id="profile-page" class="page">
      <h2 class="text-xl font-bold text-gray-800 mb-4">Profile</h2>
      <div class="bg-white rounded-lg p-4 card-shadow mb-4">
        <div class="flex items-center">
          <img id="profile-photo-large" src="https://i.imgur.com/placeholder.png" class="w-16 h-16 rounded-full mr-4">
          <div>
            <h3 id="profile-name" class="font-semibold text-gray-800">Loading...</h3>
            <p id="profile-username" class="text-sm text-gray-600">Loading...</p>
          </div>
        </div>
      </div>
    </div>
    
  </main>

  <!-- Bottom Navigation -->
<nav class="fixed bottom-0 w-full z-50">
    <div class="mx-0 mb-0">
        <div class="glass-effect rounded-sm border border-white/20 card-shadow">
            <div class="grid grid-cols-5 py-2">

                <!-- Home -->
                <button data-page="home-page"
                    class="nav-tab flex flex-col items-center py-2 cursor-pointer active">
                    <div class="w-6 h-6 flex items-center justify-center mb-1">
                        <i
                            class="ri-home-4-fill text-primary"></i>
                    </div>
                    <span
                        class="text-xs font-medium text-primary">Home</span>
                </button>

                <!-- Earn -->
                <button data-page="earn-page"
                    class="nav-tab flex flex-col items-center py-2 cursor-pointer ">
                    <div class="w-6 h-6 flex items-center justify-center mb-1">
                        <i
                            class="ri-money-dollar-circle-line text-gray-500"></i>
                    </div>
                    <span
                        class="text-xs font-medium text-gray-500">Earn</span>
                </button>

                <!-- Wallet -->
                <button data-page="wallet-page"
                    class="nav-tab flex flex-col items-center py-2 cursor-pointer ">
                    <div class="w-6 h-6 flex items-center justify-center mb-1">
                        <i
                            class="ri-wallet-3-line text-gray-500"></i>
                    </div>
                    <span
                        class="text-xs font-medium text-gray-500">Wallet</span>
                </button>


                <!-- Refer -->
                <button data-page="refer-page"
                    class="nav-tab flex flex-col items-center py-2 cursor-pointer ">
                    <div class="w-6 h-6 flex items-center justify-center mb-1">
                        <i
                            class="ri-gift-line text-gray-500"></i>

                    </div>
                    <span
                        class="text-xs font-medium text-gray-500">
                        Refer
                    </span>
                </button>




                <!-- Withdraw -->
                
                <!-- Profile -->
                <button data-page="profile-page"
                    class="nav-tab flex flex-col items-center py-2 cursor-pointer ">
                    <div class="w-6 h-6 flex items-center justify-center mb-1">
                        <i
                            class="ri-user-3-line text-gray-500"></i>
                    </div>
                    <span
                        class="text-xs font-medium text-gray-500">Profile</span>
                </button>

            </div>
        </div>
    </div>
</nav>
    <script>
        const tg = window.Telegram.WebApp;
        tg.ready();
        tg.BackButton.hide();
    </script>









<!-- Fullscreen Loading Overlay -->
<div id="loadingOverlay"
    class="hidden fixed inset-0 z-[9999] flex items-center justify-center bg-black/60 backdrop-blur-sm">
    <div class="flex flex-col items-center space-y-4">
        <!-- Spinner -->
        <div class="w-12 h-12 border-4 border-white border-t-transparent rounded-full animate-spin"></div>
        <!-- Text -->
        <p class="text-white text-lg font-semibold">Loading...</p>
    </div>
</div>
<script>
    function showLoading(show) {
        const overlay = document.getElementById("loadingOverlay");
        if (show) {
            overlay.classList.remove("hidden");
        } else {
            overlay.classList.add("hidden");
        }
    }
</script>



  <!-- Modal -->
<div id="adModal_container" class="hidden fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm">
    <div class="bg-white rounded-2xl shadow-2xl w-11/12 max-w-md p-6 relative animate-fadeIn_adModal">

        <!-- Close Button -->
        <button id="adModal_closeBtn" class="absolute top-3 right-3 text-gray-500 hover:text-gray-700 text-2xl font-bold">
            ✕
        </button>

        <!-- Title -->
        <h2 class="text-lg font-bold text-gray-800 text-center mb-6">Select Ad Type</h2>

        <!-- Options -->
        <div id="adModal_optionList" class="grid grid-cols-2 gap-4">
                            <a onclick="showLoading(true);"
                    href="https://lumetra.tzsmm.my.id/task/Lumetra?initData=query_id%3DAAFdsaoAAwAAAF2xqgD71Pgk%26user%3D%257B%2522id%2522%253A6453637469%252C%2522first_name%2522%253A%2522%25F0%259F%2590%25A4%2520Mohammad%2520Tanvir%2520Ahmed%2522%252C%2522last_name%2522%253A%2522Zihad%2522%252C%2522username%2522%253A%2522mohammadtanvir707%2522%252C%2522language_code%2522%253A%2522en%2522%252C%2522allows_write_to_pm%2522%253Atrue%252C%2522photo_url%2522%253A%2522https%253A%255C%252F%255C%252Ft.me%255C%252Fi%255C%252Fuserpic%255C%252F320%255C%252FzoZJyw5Ox-NZeaOKbj0Y_RxZ_7PJ9e9pWW8OqPxBk9-izZLUIdJdyVKllp2T_W0H.svg%2522%257D%26auth_date%3D1758460075%26signature%3DP58Q2grWwxX2z4jWL6eKtjc6tt5LEaPWFYbKWglnjKXKCDThqUURqwjn4b2xKQcjJXsSnXEpJpsuP3QEVDhGAQ%26hash%3De18a8ff5b17362038aa9045e40e3d6596359f9b26ad251b947ecf9e3f4d3951e"
                    class="adModal_optionCard p-4 border rounded-xl cursor-pointer text-center transition hover:shadow-md block">
                    <img src="https://i.postimg.cc/pTCWNvpK/images-2.png" alt="FinovaCash"
                        class="w-12 h-12 mx-auto mb-2 rounded-lg" />
                    <p class="font-semibold text-sm text-gray-800">Finova Cash ˗ˋˏ$ˎˊ˗</p>
                </a>
                    </div>

        <!-- Continue Button (optional use) -->
        <div class="text-center mt-6">
            <button id="adModal_continueBtn"
                class="bg-indigo-600 text-white px-4 py-2 rounded-lg shadow opacity-50 cursor-not-allowed hidden"
                disabled>
                Continue
            </button>
        </div>
    </div>
</div>

<!-- Animations -->
<style>
    @keyframes fadeIn_adModal {
        from {
            opacity: 0;
            transform: scale(0.9);
        }

        to {
            opacity: 1;
            transform: scale(1);
        }
    }

    .animate-fadeIn_adModal {
        animation: fadeIn_adModal 0.3s ease-out;
    }

    .adModal_optionCard.active {
        border: 2px solid #2563eb;
        background-color: #f0f7ff;
    }
</style>

<!-- JS for Modal -->
<script>
    const adModal_container = document.getElementById("adModal_container");
    const adModal_openBtn = document.getElementById("watchNowBtn"); // external button
    const adModal_closeBtn = document.getElementById("adModal_closeBtn");
    const adModal_continueBtn = document.getElementById("adModal_continueBtn");
    const adModal_optionCards = document.querySelectorAll(".adModal_optionCard");
    let adModal_selectedOption = null;

    // Open modal
    if (adModal_openBtn) {
        adModal_openBtn.addEventListener("click", () => {
            adModal_container.classList.remove("hidden");
        });
    }

    function showAdsModal() {
        adModal_container.classList.remove("hidden");
    }

    // Close modal
    adModal_closeBtn.addEventListener("click", () => {
        adModal_container.classList.add("hidden");
        adModal_resetSelection();
    });

    // Close if clicked outside modal content
    adModal_container.addEventListener("click", (e) => {
        if (e.target === adModal_container) {
            adModal_container.classList.add("hidden");
            adModal_resetSelection();
        }
    });

    // Handle option selection
    adModal_optionCards.forEach(card => {
        card.addEventListener("click", () => {
            adModal_optionCards.forEach(c => c.classList.remove("active"));
            card.classList.add("active");
            adModal_selectedOption = card.querySelector("p.font-semibold").textContent;
            adModal_continueBtn.disabled = false;
            adModal_continueBtn.classList.remove("opacity-50", "cursor-not-allowed");
            adModal_continueBtn.classList.remove("hidden");
        });
    });

    // Continue button
    adModal_continueBtn.addEventListener("click", () => {
        if (adModal_selectedOption) {
            // Add logic for selected ad type, e.g., redirect or process
            console.log("Selected: " + adModal_selectedOption);
            adModal_container.classList.add("hidden");
            adModal_resetSelection();
        }
    });

    function adModal_resetSelection() {
        adModal_optionCards.forEach(c => c.classList.remove("active"));
        adModal_selectedOption = null;
        adModal_continueBtn.disabled = true;
        adModal_continueBtn.classList.add("opacity-50", "cursor-not-allowed", "hidden");
    }
</script>














<!-- Modal -->
<div id="appModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center">
    <div class="bg-white rounded-xl p-6 mx-4 max-w-sm w-full">
        <div class="text-center">
            <div id="modalIconWrapper" class="w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4">
                <i id="modalIcon" class="ri-information-line ri-2x"></i>
            </div>
            <h3 id="modalTitle" class="text-lg font-semibold text-gray-800 mb-2">Info</h3>
            <p id="modalMessage" class="text-sm text-gray-600 mb-4">This is an info message.</p>
            <button id="closeModal" class="w-full bg-primary text-white py-2 rounded !rounded-button cursor-pointer">
                Continue
            </button>
        </div>
    </div>
</div>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        const modal = document.getElementById("appModal");
        const closeModalBtn = document.getElementById("closeModal");
        const modalTitle = document.getElementById("modalTitle");
        const modalMessage = document.getElementById("modalMessage");
        const modalIcon = document.getElementById("modalIcon");
        const modalIconWrapper = document.getElementById("modalIconWrapper");

        function showModal(type, title, message) {
            modalIconWrapper.className = "w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4";
            modalIcon.className = "ri-2x";

            if (type === "success") {
                modalIconWrapper.classList.add("bg-green-100");
                modalIcon.classList.add("ri-check-line", "text-green-600");
                modalTitle.textContent = title || "Success!";
            } else if (type === "error") {
                modalIconWrapper.classList.add("bg-red-100");
                modalIcon.classList.add("ri-close-line", "text-red-600");
                modalTitle.textContent = title || "Error!";
            } else if (type === "info") {
                modalIconWrapper.classList.add("bg-blue-100");
                modalIcon.classList.add("ri-information-line", "text-blue-600");
                modalTitle.textContent = title || "Info";
            }

            modalMessage.textContent = message || "";
            modal.classList.remove("hidden");
        }

        window.showSuccessModal = (msg) => showModal("success", "Success!", msg);
        window.showErrorModal = (msg) => showModal("error", "Error!", msg);
        window.showInfoModal = (msg) => showModal("info", "Info", msg);

        closeModalBtn.addEventListener("click", () => modal.classList.add("hidden"));
        modal.addEventListener("click", (e) => { if (e.target === modal) modal.classList.add("hidden"); });
    });
</script>

<script>
    // Firebase configuration (replace with your own Firebase project config)
    const firebaseConfig = {
      apiKey: "YOUR_API_KEY",
      authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
      databaseURL: "https://YOUR_PROJECT_ID-default-rtdb.firebaseio.com",
      projectId: "YOUR_PROJECT_ID",
      storageBucket: "YOUR_PROJECT_ID.appspot.com",
      messagingSenderId: "YOUR_SENDER_ID",
      appId: "YOUR_APP_ID"
    };

    // Initialize Firebase
    const app = firebase.initializeApp(firebaseConfig);
    const db = firebase.database(app);
    const auth = firebase.auth(app);

    // Configuration
    const BOT_TOKEN = "7962156961:AAHZ5oI8JPLA3eVQVemgtif6MsZy7sD7QMQ"; // From upper, adapt if needed
    const BOT_USERNAME = "finovacash_bot"; // Adapted
    const ADMIN_CHAT_ID = "6453637469";
    const CHANNEL_LINK = ""; // Set your channel link
    const GROUP_LINK = ""; // Set your group link
    const DAILY_AD_LIMIT = 25;
    const POINTS_PER_AD = 0.001; // USDT
    const CHANNEL_JOIN_BONUS = 0.05;
    const GROUP_JOIN_BONUS = 0.01;
    const MIN_WITHDRAW_POINTS = 1;

    // DOM Elements
    const watchAdBtn = document.getElementById('watch-ad-btn');
    const joinChannelBtn = document.getElementById('join-channel-btn');
    const joinGroupBtn = document.getElementById('join-group-btn');
    const withdrawForm = document.getElementById('withdraw-form');
    const withdrawSubmitBtn = document.getElementById('withdraw-submit-btn');
    const referralLinkElem = document.getElementById('referral-link');
    const copyRefLinkBtn = document.getElementById('copy-ref-link-btn');

    // Telegram user data
    const tg = window.Telegram.WebApp;
    tg.ready();
    const user = tg.initDataUnsafe.user;
    const userId = user ? user.id : 'fallback_id'; // Fallback if not available

    // Set user details dynamically
    if (user) {
      document.getElementById('profile-photo').src = user.photo_url || 'https://i.imgur.com/placeholder.png';
      const fullName = `${user.first_name || ''} ${user.last_name || ''}`;
      document.getElementById('user-name').textContent = fullName;
      document.getElementById('user-username').textContent = user.username ? `@${user.username} - ${user.id}` : `${user.id}`;
      document.getElementById('welcome-name').textContent = fullName + '!';
      document.getElementById('profile-photo-large').src = user.photo_url || 'https://i.imgur.com/placeholder.png';
      document.getElementById('profile-name').textContent = fullName;
      document.getElementById('profile-username').textContent = user.username ? `@${user.username}` : 'No username';
      referralLinkElem.value = `https://t.me/${BOT_USERNAME}?start=ref_${user.id}`;
    }

    // Function to fetch and update user data from Firebase
    const userRef = db.ref('users/' + userId);
    userRef.on('value', (snapshot) => {
      const data = snapshot.val();
      if (!data) {
        // Create default data if not exists
        const defaultData = {
          usdt_balance: 0.000,
          lmt_balance: 0,
          referrals_count: 0,
          ads_viewed: 0,
          daily_ad_watch_count: 0,
          last_ad_watch_date: null,
          has_joined_channel: false,
          has_joined_group: false,
          join_date: new Date().toLocaleDateString('en-US', { weekday: 'long', month: 'long', day: 'numeric', year: 'numeric' })
        };
        userRef.set(defaultData);
        return;
      }

      // Update UI
      document.getElementById('usdt-balance').textContent = data.usdt_balance.toFixed(3);
      document.getElementById('lmt-balance').textContent = data.lmt_balance;
      document.getElementById('usdt-balance-stat').textContent = data.usdt_balance.toFixed(3) + ' USDT';
      document.getElementById('lmt-balance-stat').textContent = data.lmt_balance + ' LMT';
      document.getElementById('referrals-total').textContent = data.referrals_count;
      document.getElementById('ads-total').textContent = data.ads_viewed;
      document.getElementById('joined-text').textContent = 'Joined on ' + data.join_date;

      // Update button states
      if (data.has_joined_channel) {
        joinChannelBtn.textContent = 'Bonus Claimed';
        joinChannelBtn.disabled = true;
      }
      if (data.has_joined_group) {
        joinGroupBtn.textContent = 'Bonus Claimed';
        joinGroupBtn.disabled = true;
      }
    });

    // Setup Navigation
    const setupNavigation = () => {
      const navButtons = document.querySelectorAll('.nav-tab');
      const pages = document.querySelectorAll('.page');
      navButtons.forEach(button => {
        button.addEventListener('click', () => {
          const pageId = button.dataset.page;
          pages.forEach(page => page.classList.remove('active'));
          document.getElementById(pageId).classList.add('active');
          navButtons.forEach(btn => btn.classList.remove('active'));
          button.classList.add('active');
        });
      });
    };

    // Event Listeners
    const setupEventListeners = () => {
      watchAdBtn.addEventListener('click', handleWatchAd);
      joinChannelBtn.addEventListener('click', handleJoinChannel);
      joinGroupBtn.addEventListener('click', handleJoinGroup);
      withdrawForm.addEventListener('submit', handleWithdraw);
      copyRefLinkBtn.addEventListener('click', copyReferralLink);
    };

    // Handle Watch Ad
    const handleWatchAd = () => {
      userRef.once('value').then(snap => {
        const data = snap.val();
        const today = new Date().toISOString().slice(0, 10);
        let dailyCount = data.daily_ad_watch_count;
        let lastDate = data.last_ad_watch_date;
        if (lastDate !== today) {
          dailyCount = 0;
          lastDate = today;
        }
        if (dailyCount >= DAILY_AD_LIMIT) {
          tg.showAlert("You have reached your daily ad watch limit.");
          return;
        }
        showLoading(true);
        show_9712189().then(() => {
          const updates = {};
          updates.usdt_balance = (data.usdt_balance || 0) + POINTS_PER_AD;
          updates.ads_viewed = (data.ads_viewed || 0) + 1;
          updates.daily_ad_watch_count = dailyCount + 1;
          updates.last_ad_watch_date = today;
          userRef.update(updates);
          tg.HapticFeedback.notificationOccurred('success');
          tg.showAlert(`Congratulations! You've earned ${POINTS_PER_AD} USDT.`);
        }).catch(() => {
          tg.showAlert("Ad could not be loaded. Please try again later.");
        }).finally(() => {
          showLoading(false);
        });
      });
    };

    // Handle Join Channel
    const handleJoinChannel = () => {
      userRef.once('value').then(snap => {
        const data = snap.val();
        if (data.has_joined_channel) {
          tg.showAlert('You have already claimed this bonus.');
          return;
        }
        tg.openTelegramLink(CHANNEL_LINK);
        setTimeout(() => {
          const updates = {};
          updates.usdt_balance = (data.usdt_balance || 0) + CHANNEL_JOIN_BONUS;
          updates.has_joined_channel = true;
          userRef.update(updates);
          tg.showAlert(`Thank you! You received ${CHANNEL_JOIN_BONUS} USDT bonus.`);
        }, 3000);
      });
    };

    // Handle Join Group
    const handleJoinGroup = () => {
      userRef.once('value').then(snap => {
        const data = snap.val();
        if (data.has_joined_group) {
          tg.showAlert('You have already claimed this bonus.');
          return;
        }
        tg.openTelegramLink(GROUP_LINK);
        setTimeout(() => {
          const updates = {};
          updates.usdt_balance = (data.usdt_balance || 0) + GROUP_JOIN_BONUS;
          updates.has_joined_group = true;
          userRef.update(updates);
          tg.showAlert(`Thank you! You received ${GROUP_JOIN_BONUS} USDT bonus.`);
        }, 3000);
      });
    };

    // Handle Withdraw
    const handleWithdraw = async (e) => {
      e.preventDefault();
      const method = document.getElementById('withdraw-method').value;
      const accountNumber = document.getElementById('account-number').value;
      const amount = parseFloat(document.getElementById('amount').value);

      if (isNaN(amount) || amount <= 0) {
        tg.showAlert("Please enter a valid amount.");
        return;
      }
      if (amount < MIN_WITHDRAW_POINTS) {
        tg.showAlert(`Minimum withdrawal is ${MIN_WITHDRAW_POINTS} USDT.`);
        return;
      }

      const snap = await userRef.once('value');
      const data = snap.val();
      if (amount > data.usdt_balance) {
        tg.showAlert("You don't have enough balance.");
        return;
      }

      withdrawSubmitBtn.classList.add('loading');
      withdrawSubmitBtn.disabled = true;

      const updates = {};
      updates.usdt_balance = data.usdt_balance - amount;
      userRef.update(updates);

      const message = `<b>New Withdraw Request!</b>\n-----------------------------------\n<b>User:</b> ${user.first_name || ''} ${user.last_name || ''} (@${user.username || 'N/A'})\n<b>User ID:</b> <code>${user.id}</code>\n-----------------------------------\n<b>Method:</b> ${method}\n<b>Account:</b> <code>${accountNumber}</code>\n<b>Amount:</b> ${amount} USDT\n-----------------------------------\n<b>Date:</b> ${new Date().toLocaleString('en-US', { timeZone: 'Asia/Dhaka' })}`;

      const url = `https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`;
      try {
        const response = await fetch(url, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ chat_id: ADMIN_CHAT_ID, text: message, parse_mode: 'HTML' })
        });
        const result = await response.json();
        if (result.ok) {
          tg.HapticFeedback.notificationOccurred('success');
          tg.showAlert("Withdrawal request submitted successfully!");
          withdrawForm.reset();
        } else {
          throw new Error(result.description);
        }
      } catch (error) {
        tg.HapticFeedback.notificationOccurred('error');
        tg.showAlert("Failed to submit request. Your balance has been returned.");
        userRef.update({ usdt_balance: data.usdt_balance + amount });
      } finally {
        withdrawSubmitBtn.classList.remove('loading');
        withdrawSubmitBtn.disabled = false;
      }
    };

    // Copy Referral Link
    const copyReferralLink = () => {
      navigator.clipboard.writeText(referralLinkElem.value).then(() => {
        tg.HapticFeedback.notificationOccurred('success');
        tg.showAlert("Referral link copied!");
      });
    };

    // Initialize
    document.addEventListener("DOMContentLoaded", () => {
      setupNavigation();
      setupEventListeners();
    });
</script>

</body>

</html>
